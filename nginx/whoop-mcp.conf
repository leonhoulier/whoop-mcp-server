# Whoop MCP Server Nginx Configuration
# Add this to your Nginx server block for mcp.leonhoulier.com

# Whoop MCP Server - Streamable HTTP
location /whoop/mcp {
    proxy_pass http://localhost:8003/mcp;
    proxy_http_version 1.1;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_set_header Accept "application/json, text/event-stream";
    proxy_buffering off;
}

# Whoop OAuth Callback
location /whoop/callback {
    proxy_pass http://localhost:8003/callback;
    proxy_http_version 1.1;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}

# Whoop Re-authentication Endpoint
location /whoop/reauth {
    proxy_pass http://localhost:8003/reauth;
    proxy_http_version 1.1;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}

# Whoop Documentation Server
location = /whoop/ {
    proxy_pass http://localhost:8005/;
    proxy_http_version 1.1;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}

# Health Check
location /whoop/health {
    proxy_pass http://localhost:8003/health;
    proxy_http_version 1.1;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}
